<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <title>Campus | Admin</title>
 <!-- Theme -->
  <link rel="stylesheet" href="./css/style.css">

  <!-- Vue + Axios -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f4f4;
    }

    header {
      background: #000;
  color: var(--yellow);
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header nav a {
  color: var(--yellow);
      margin-left: 20px;
      text-decoration: none;
      font-weight: 500;
    }

    header nav a.active {
      text-decoration: underline;
    }

    main {
      padding: 30px;
      max-width: 1100px;
      margin: auto;
    }

    .card {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    select, input {
      width: 100%;
      padding: 6px;
      margin-top: 4px;
    }

    button {
      background: #000;
      color: var(--yellow);
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }

    .thumb {
      max-width: 200px;
      margin-top: 10px;
      cursor: pointer;
    }

    .image-modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .image-modal img {
      max-width: 95vw;
      max-height: 95vh;
    }
  </style>
</head>

<body>

<header>
<header>
  <div class="logo">Campus ‚Äì Admin</div>

  <nav class="nav">
  
    <span class="divider"></span>

  </nav>
</header>
  <nav>
      <a href="/issues.html">Issues</a>
    <a href="/rooms.html">Rooms</a>

    <a href="/it.html">IT</a>
    <a href="/udstyr.html">Udstyr</a>
    <a href="/cleaning.html">Reng√∏ring</a>
    <a href="/kontor.html">Kontor</a>
    </nav>

</header>


<main>
  <div id="app">

    <!-- OPRET ROOM + QR -->
<div class="card">
  <h2>‚ûï Opret Room</h2>

  <label>Room navn</label>
  <input v-model="newRoom.roomName" placeholder="Fx Lokale 101">

  <label>Bygning</label>
  <input v-model="newRoom.building" placeholder="Fx Hovedbygning">

  <button @click="createRoom">Opret room</button>

  <div v-if="createdRoom" style="margin-top:15px">
    <p><strong>QR-kode til {{ createdRoom.roomName }}</strong></p>

    <img
      :src="qrImageUrl"
      alt="QR kode"
      style="width:250px; display:block; margin:10px 0"
    >

    <button @click="downloadQr">‚¨áÔ∏è Download QR</button>
    <button @click="printQr">üñ®Ô∏è Print QR</button>

    <p class="meta">{{ qrUrl }}</p>
  </div>
</div>


    <!-- DASHBOARD -->
    <div class="card">
      <h2>üìä Overblik</h2>

      <label>Periode</label>
      <select v-model="period">
        <option :value="7">7 dage</option>
        <option :value="30">30 dage</option>
        <option :value="90">90 dage</option>
      </select>

      <p><strong>√Öbne sager:</strong> {{ openCount }}</p>
      <p><strong>Lukkede (periode):</strong> {{ closedCount }}</p>
      <p><strong>Gns. l√∏sningstid:</strong> {{ avgResolution }} dage</p>
    </div>


    

    <!-- FILTER -->
    <div class="card">
      <label>Filtrer status</label>
      <select v-model="filterStatus">
        <option value="alle">Alle</option>
        <option>Ny</option>
        <option>I gang</option>
        <option>Lukket</option>
      </select>
    </div>

    <!-- ISSUES -->
    <div
      v-for="i in filteredIssues"
      :key="i.idissue"
      class="card"
    >
      <h3>{{ i.title }}</h3>
      <p>{{ i.description }}</p>

      <p><strong>Room ID:</strong> {{ i.roomId }}</p>

      <label>Status</label>
      <select v-model="i.status">
        <option>Ny</option>
        <option>I gang</option>
        <option>Lukket</option>
      </select>

      <label>Severity</label>
      <select v-model="i.severity">
        <option>Lav</option>
        <option>Middel</option>
        <option>H√∏j</option>
      </select>

      <label>Kategori</label>
      <select v-model.number="i.categoryId">
        <option :value="null">Ingen</option>
        <option :value="1">IT</option>
        <option :value="2">Udstyr</option>
        <option :value="3">Reng√∏ring</option>
        <option :value="5">Administrativ</option>
      </select>

      <button @click="save(i)">üíæ Gem</button>

      <div v-if="i.imageUrl">
        <img class="thumb" :src="i.imageUrl" @click="openImage(i.imageUrl)">
      </div>
    </div>

    <!-- IMAGE POPUP -->
    <div v-if="selectedImage" class="image-modal" @click="selectedImage=null">
      <img :src="selectedImage">
    </div>

    <p v-if="error" style="color:red">{{ error }}</p>

  </div>
</main>

<script src="admin.js"></script>
</body>
</html>
