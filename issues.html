<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />

  <!--
    Klar og genkendelig titel
    â†’ Nielsen: Match between system and the real world
  -->
  <title>Campus | Issues</title>

  <!-- Theme -->
  <link rel="stylesheet" href="./css/style.css">

  <!-- Vue + Axios -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>

<!--
  FÃ¦lles header for staff/admin-sider
  â†’ Nielsen: Consistency and standards
-->
<header class="topbar">
  <div class="logo">Campus</div>
  <nav>
    <a href="rooms.html">Rooms</a>
    <a class="active" href="issues.html">Issues</a>
  </nav>
</header>

<main class="container">

  <!--
    Klar sideoverskrift
    â†’ Nielsen: Visibility of system status
  -->
  <h1>Issues</h1>

  <div id="app">

    <!--
      Filter og handling samlet
      â†’ Gestalt: NÃ¦rhed (proximity)
      â†’ Nielsen: Flexibility and efficiency of use
    -->
    <div style="margin-bottom:20px">
      <label><strong>Status filter</strong></label><br>
      <select v-model="filterStatus">
        <option value="alle">Alle</option>
        <option value="open">Ã…bne</option>
        <option value="closed">Lukkede</option>
      </select>
    </div>

    <!--
      PrimÃ¦r handling (load)
      â†’ Nielsen: Visibility of system status
    -->
    <button class="primary-btn" @click="getAllIssues">
      IndlÃ¦s issues
    </button>

    <!--
      Fejl vises kun ved behov
      â†’ Nielsen: Help users recognize and diagnose errors
    -->
    <p class="error" v-if="error">{{ error }}</p>

    <!--
      Grid-layout for issues
      â†’ Gestalt: Common region
    -->
    <div class="card-grid" v-if="filteredIssues.length">

      <!--
        Ensartede cards
        â†’ Gestalt: Ensartethed (similarity)
        â†’ Nielsen: Consistency and standards
      -->
      <div class="card" v-for="issue in filteredIssues" :key="issue.idissue">

        <h2>{{ issue.title }}</h2>
        <p>{{ issue.description }}</p>

        <!--
          Relateret metadata samlet
          â†’ Gestalt: NÃ¦rhed
        -->
        <p><strong>Status:</strong> {{ issue.status }}</p>
        <p><strong>Severity:</strong> {{ issue.severity }}</p>

        <!--
          Lokaleinformation i naturligt sprog
          â†’ Nielsen: Match between system and the real world
        -->
        <p>
          <strong>Lokale:</strong>
          {{ issue.roomName || "Room #" + issue.roomId }}
        </p>

        <!--
          Lukket dato vises kun hvis relevant
          â†’ Nielsen: Aesthetic and minimalist design
        -->
        <p v-if="issue.closedAt">
          <strong>Lukket:</strong>
          {{ formatDate(issue.closedAt) }}
        </p>

        <!--
          Kritisk handling (slet)
          â†’ Nielsen: Error prevention (bevidst handling)
        -->
        <button
          class="primary-btn danger"
          @click="deleteIssue(issue.idissue)"
        >
          ðŸ—‘ Slet issue
        </button>

      </div>
    </div>

    <!--
      Tom-tilstand forklares tydeligt
      â†’ Nielsen: Visibility of system status
    -->
    <p v-else class="muted">Ingen issues fundetâ€¦</p>

  </div>
</main>

<!--
  Footer adskilt visuelt fra funktionelt indhold
  â†’ Gestalt: Figur / baggrund
-->
<footer class="footer">
  Campus Support
</footer>

<script src="./issues.js"></script>
</body>
</html>
