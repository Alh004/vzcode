<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <title>Campus | Issues</title>

  <!-- Theme -->
  <link rel="stylesheet" href="./css/style.css">

  <!-- Vue + Axios -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>

<header class="topbar">
  <div class="logo">Campus</div>
  <nav>
    <a href="rooms.html">Rooms</a>
    <a class="active" href="issues.html">Issues</a>
  </nav>
</header>

<main class="container">
  <h1>Issues</h1>

  <div id="app">

    <!-- FILTER -->
    <label>Status filter</label>
    <select v-model="filterStatus">
      <option value="alle">Alle</option>
      <option value="open">Åbne</option>
      <option value="closed">Lukkede</option>
    </select>

    <button class="primary-btn" @click="getAllIssues">
      Load Issues
    </button>

    <p class="error" v-if="error">{{ error }}</p>

    <div class="card-grid" v-if="filteredIssues.length">
      <div class="card" v-for="issue in filteredIssues" :key="issue.idissue">

        <h2>{{ issue.title }}</h2>

        <p>{{ issue.description }}</p>

        <p><strong>Status:</strong> {{ issue.status }}</p>
        <p><strong>Severity:</strong> {{ issue.severity }}</p>

        <!-- ROOM -->
        <p>
          <strong>Lokale:</strong>
          {{ issue.roomName || "Room #" + issue.roomId }}
        </p>

        <!-- CLOSED DATE -->
        <p v-if="issue.closedAt">
          <strong>Lukket:</strong>
          {{ formatDate(issue.closedAt) }}
        </p>

        <!-- DELETE -->
        <button
          style="background:#c62828;color:white"
          @click="deleteIssue(issue.idissue)"
        >
          Slet issue
        </button>

      </div>
    </div>

    <p v-else class="muted">Ingen issues fundet…</p>
  </div>
</main>

<script src="./issues.js"></script>
</body>
</html>
